# WaveSpectra2Text
# åŒè¾“å…¥è¯­éŸ³è¯†åˆ«ç³»ç»Ÿ - éŸ³é¢‘ä¸é¢‘è°±ç‰¹å¾

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªæ”¯æŒåŒè¾“å…¥æ¨¡å¼çš„è¯­éŸ³è¯†åˆ«ç³»ç»Ÿã€‚ç³»ç»Ÿæ”¯æŒä¸¤ç§è¾“å…¥æ–¹å¼ï¼š
1. **åŸå§‹éŸ³é¢‘è¾“å…¥**ï¼šå®Œæ•´çš„éŸ³é¢‘å¤„ç†æµç¨‹ï¼ˆéŸ³é¢‘ â†’ é¢‘è°±æå– â†’ æ¨¡å‹æ¨ç† â†’ æ–‡æœ¬ï¼‰
2. **é¢‘è°±ç‰¹å¾è¾“å…¥**ï¼šè·³è¿‡é¢„å¤„ç†çš„å¿«é€Ÿæ¨ç†ï¼ˆé¢„å¤„ç†é¢‘è°± â†’ æ¨¡å‹æ¨ç† â†’ æ–‡æœ¬ï¼‰

ç°åœ¨ä»¥ä¸­æ–‡æ•°å­—1ï½10ä¸ºä¾‹ï¼Œå±•ç¤ºäº†ä»é¢‘è°±ç‰¹å¾åˆ°æ–‡æœ¬çš„ç«¯åˆ°ç«¯è¯†åˆ«èƒ½åŠ›ã€‚

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WaveSpectra2Text ç³»ç»Ÿæ¶æ„                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   éŸ³é¢‘è¾“å…¥    â”‚    â”‚  é¢‘è°±è¾“å…¥    â”‚    â”‚   æ–‡æœ¬è¾“å‡º    â”‚      â”‚
â”‚  â”‚  (.wav)     â”‚    â”‚  (.npy)     â”‚    â”‚  (ä¸­æ–‡æ•°å­—)   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                   â”‚                   â–²            â”‚
â”‚         â–¼                   â”‚                   â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚                   â”‚            â”‚
â”‚  â”‚ éŸ³é¢‘é¢„å¤„ç†   â”‚            â”‚                   â”‚            â”‚
â”‚  â”‚ (librosa)  â”‚            â”‚                   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚                   â”‚            â”‚
â”‚         â”‚                   â”‚                   â”‚            â”‚
â”‚         â–¼                   â–¼                   â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚            Transformer æ¨¡å‹                  â”‚            â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚            â”‚
â”‚  â”‚  â”‚  ç¼–ç å™¨      â”‚    â”‚   è§£ç å™¨     â”‚          â”‚            â”‚
â”‚  â”‚  â”‚ (Encoder)   â”‚    â”‚ (Decoder)   â”‚          â”‚            â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                   â”‚                   â”‚            â”‚
â”‚         â–¼                   â–¼                   â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚            â”‚
â”‚  â”‚ é¢‘è°±ç‰¹å¾     â”‚    â”‚ æ³¨æ„åŠ›æœºåˆ¶    â”‚            â”‚            â”‚
â”‚  â”‚ (200Ã—513)   â”‚    â”‚ (Multi-Head) â”‚            â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚            â”‚
â”‚         â”‚                   â”‚                   â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚              æ¨ç†ç­–ç•¥                        â”‚            â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚            â”‚
â”‚  â”‚  â”‚  è´ªå©ªè§£ç     â”‚    â”‚   æŸæœç´¢     â”‚          â”‚            â”‚
â”‚  â”‚  â”‚ (Greedy)    â”‚    â”‚ (Beam)     â”‚          â”‚            â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                             â”‚                                â”‚
â”‚                             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚              è¯æ±‡è¡¨è§£ç                       â”‚            â”‚
â”‚  â”‚         (ä¸­æ–‡æ•°å­—1-10 + ç‰¹æ®Šç¬¦å·)              â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                             â”‚                                â”‚
â”‚                             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚              åå¤„ç†                         â”‚            â”‚
â”‚  â”‚         (æ™ºèƒ½å›é€€æœºåˆ¶)                        â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
WaveSpectra2Text/
â”œâ”€â”€ ğŸ“ src/                           # æºä»£ç ç›®å½•
â”‚   â””â”€â”€ ğŸ“ wavespectra2text/          # ä¸»åŒ…
â”‚       â”œâ”€â”€ ğŸ“„ __init__.py            # åŒ…åˆå§‹åŒ–
â”‚       â”œâ”€â”€ ğŸ“ core/                  # æ ¸å¿ƒæ¨¡å—
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ model.py          # Transformeræ¨¡å‹
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ vocab.py          # è¯æ±‡è¡¨ç®¡ç†
â”‚       â”‚   â””â”€â”€ ğŸ“„ inference.py      # æ¨ç†æ ¸å¿ƒ
â”‚       â”œâ”€â”€ ğŸ“ data/                  # æ•°æ®å¤„ç†æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ preprocessing.py  # éŸ³é¢‘é¢„å¤„ç†
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ dataset.py        # æ•°æ®é›†ç±»
â”‚       â”‚   â””â”€â”€ ğŸ“„ utils.py          # æ•°æ®å·¥å…·
â”‚       â”œâ”€â”€ ğŸ“ training/              # è®­ç»ƒæ¨¡å—
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ trainer.py        # è®­ç»ƒåŸºç±»
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ config.py         # é…ç½®ç®¡ç†
â”‚       â”‚   â””â”€â”€ ğŸ“„ callbacks.py     # è®­ç»ƒå›è°ƒ
â”‚       â”œâ”€â”€ ğŸ“ inference/             # æ¨ç†æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ recognizer.py     # è¯†åˆ«å™¨
â”‚       â”‚   â””â”€â”€ ğŸ“„ strategies.py     # è§£ç ç­–ç•¥
â”‚       â””â”€â”€ ğŸ“ utils/                 # å·¥å…·æ¨¡å—
â”‚           â”œâ”€â”€ ğŸ“„ __init__.py
â”‚           â”œâ”€â”€ ğŸ“„ audio.py          # éŸ³é¢‘å·¥å…·
â”‚           â”œâ”€â”€ ğŸ“„ logging.py        # æ—¥å¿—å·¥å…·
â”‚           â””â”€â”€ ğŸ“„ metrics.py       # è¯„ä¼°æŒ‡æ ‡
â”‚
â”œâ”€â”€ ğŸ“ scripts/                       # è„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“„ train.py                  # è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ ğŸ“„ inference.py             # æ¨ç†è„šæœ¬
â”‚   â”œâ”€â”€ ğŸ“„ preprocess.py            # é¢„å¤„ç†è„šæœ¬
â”‚   â””â”€â”€ ğŸ“„ evaluate.py              # è¯„ä¼°è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“ configs/                      # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“„ default.yaml             # é»˜è®¤é…ç½®
â”‚   â”œâ”€â”€ ğŸ“„ small_dataset.yaml       # å°æ•°æ®é›†é…ç½®
â”‚   â”œâ”€â”€ ğŸ“„ medium_dataset.yaml      # ä¸­ç­‰æ•°æ®é›†é…ç½®
â”‚   â””â”€â”€ ğŸ“„ large_dataset.yaml       # å¤§æ•°æ®é›†é…ç½®
â”‚
â”œâ”€â”€ ğŸ“ data/                         # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ audio/                     # åŸå§‹éŸ³é¢‘æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ Chinese_Number_01.wav     # ä¸­æ–‡æ•°å­—éŸ³é¢‘æ ·æœ¬
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ ğŸ“ features/                 # ç‰¹å¾æ–‡ä»¶
â”‚   â””â”€â”€ ğŸ“„ labels.csv                 # æ ‡ç­¾æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“ experiments/                  # å®éªŒç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ runs/                     # è®­ç»ƒè¿è¡Œè®°å½•
â”‚   â”œâ”€â”€ ğŸ“ logs/                     # æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ ğŸ“ checkpoints/              # æ¨¡å‹æ£€æŸ¥ç‚¹
â”‚
â”œâ”€â”€ ğŸ“ tests/                        # æµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”œâ”€â”€ ğŸ“„ test_model.py            # æ¨¡å‹æµ‹è¯•
â”‚   â”œâ”€â”€ ğŸ“„ test_data.py             # æ•°æ®æµ‹è¯•
â”‚   â”œâ”€â”€ ğŸ“„ test_training.py         # è®­ç»ƒæµ‹è¯•
â”‚   â””â”€â”€ ğŸ“„ test_inference.py        # æ¨ç†æµ‹è¯•
â”‚
â”œâ”€â”€ ğŸ“ examples/                     # ç¤ºä¾‹ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“„ basic_usage.py           # åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ ğŸ“„ custom_training.py       # è‡ªå®šä¹‰è®­ç»ƒç¤ºä¾‹
â”‚   â””â”€â”€ ğŸ“„ batch_inference.py      # æ‰¹é‡æ¨ç†ç¤ºä¾‹
â”‚
â”œâ”€â”€ ğŸ“„ setup.py                     # å®‰è£…è„šæœ¬
â”œâ”€â”€ ğŸ“„ pyproject.toml              # é¡¹ç›®é…ç½®
â”œâ”€â”€ ğŸ“„ requirements.txt             # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ ğŸ“„ requirements-dev.txt         # å¼€å‘ä¾èµ–
â”œâ”€â”€ ğŸ“„ .gitignore                   # Gitå¿½ç•¥æ–‡ä»¶
â””â”€â”€ ğŸ“„ LICENSE                      # è®¸å¯è¯
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…æ–¹å¼

#### 1. å¼€å‘å®‰è£…ï¼ˆæ¨èï¼‰
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/wavespectra2text/wavespectra2text.git
cd wavespectra2text

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¼€å‘æ¨¡å¼å®‰è£…
pip install -e .
```

#### 2. ä»æºç å®‰è£…
```bash
pip install .
```

#### 3. ä»…å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### åŸºæœ¬ä½¿ç”¨

#### 1. å‡†å¤‡æ•°æ®
```bash
# è‡ªåŠ¨æ‰«æéŸ³é¢‘æ–‡ä»¶å¹¶åˆ›å»ºæ ‡ç­¾æ¨¡æ¿
python setup_data.py
```

#### 2. è®­ç»ƒæ¨¡å‹
```bash
# ä½¿ç”¨ç»Ÿä¸€è®­ç»ƒè„šæœ¬
python scripts/train.py --scale small --config configs/small_dataset.yaml

# æˆ–è€…ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·ï¼ˆå®‰è£…åï¼‰
wavespectra2text-train --scale medium
```

#### 3. æ¨ç†è¯†åˆ«
```bash
# ä½¿ç”¨ç»Ÿä¸€æ¨ç†è„šæœ¬
python scripts/inference.py --model experiments/checkpoints/best_model.pth --input data/audio/Chinese_Number_01.wav

# æˆ–è€…ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·ï¼ˆå®‰è£…åï¼‰
wavespectra2text-inference --model experiments/checkpoints/best_model.pth --input data/audio/Chinese_Number_01.wav
```

#### 4. ç¼–ç¨‹æ¥å£
```python
from wavespectra2text import DualInputSpeechRecognizer, create_model, vocab

# åˆ›å»ºè¯†åˆ«å™¨
recognizer = DualInputSpeechRecognizer('experiments/checkpoints/best_model.pth')

# éŸ³é¢‘è¯†åˆ«
result = recognizer.recognize_from_audio('data/audio/Chinese_Number_01.wav')
print(f"è¯†åˆ«ç»“æœ: {result['text']}")

# é¢‘è°±è¯†åˆ«ï¼ˆæ›´å¿«ï¼‰
result = recognizer.recognize_from_spectrogram('data/features/Chinese_Number_01.npy')
print(f"è¯†åˆ«ç»“æœ: {result['text']}")
```

## æ•°æ®å‡†å¤‡

1. å°†éŸ³é¢‘æ–‡ä»¶å­˜æ”¾åœ¨ `data/audio/` ç›®å½•ä¸‹
2. åˆ›å»º `data/labels.csv` æ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```csv
filename,label
audio_1.wav,label_1
audio_2.wav,label_2
audio_3.wav,label_3
...
```

## åŒè¾“å…¥ç³»ç»Ÿæ¶æ„

### ğŸ¯ æ¨ç†æ¨¡å¼å¯¹æ¯”

| ç‰¹å¾ | éŸ³é¢‘è¾“å…¥æ¨¡å¼ | é¢‘è°±è¾“å…¥æ¨¡å¼ |
|------|-------------|-------------|
| **è¾“å…¥ç±»å‹** | åŸå§‹éŸ³é¢‘æ–‡ä»¶ (.wav, .mp3ç­‰) | é¢„å¤„ç†é¢‘è°±æ–‡ä»¶ (.npy) |
| **é¢„å¤„ç†æ—¶é—´** | 2-3ç§’ | 0ç§’ï¼ˆè·³è¿‡ï¼‰ |
| **æ¨ç†æ—¶é—´** | 0.3-0.5ç§’ | 0.3-0.5ç§’ |
| **æ€»è€—æ—¶** | 2.5-3.5ç§’ | 0.3-0.5ç§’ |
| **å†…å­˜å ç”¨** | ä¸­ç­‰ | ä½ |
| **é€‚ç”¨åœºæ™¯** | ä¸€èˆ¬ä½¿ç”¨ã€å¼€å‘æµ‹è¯• | é«˜æ€§èƒ½éœ€æ±‚ã€æ‰¹é‡å¤„ç†ã€å®æ—¶ç³»ç»Ÿ |

### ğŸ§  æ¨¡å‹æ¶æ„

- **é¢‘è°±ç¼–ç å™¨**: åŸºäºTransformerçš„ç¼–ç å™¨ï¼Œå°†STFTé¢‘è°±ç‰¹å¾ï¼ˆ200Ã—513ï¼‰ç¼–ç ä¸ºéšè—è¡¨ç¤º
- **æ³¨æ„åŠ›è§£ç å™¨**: åŸºäºTransformerçš„è§£ç å™¨ï¼Œä½¿ç”¨å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶è§£ç ä¸ºæ–‡æœ¬åºåˆ—
- **è¯æ±‡è¡¨**: æ”¯æŒä¸­æ–‡æ•°å­—1ï½10 + ç‰¹æ®Šç¬¦å·ï¼ˆPAD, SOS, EOS, UNKï¼‰ï¼Œå…±14ä¸ªtoken
- **æ¨ç†ç­–ç•¥**: æ”¯æŒè´ªå©ªè§£ç å’ŒæŸæœç´¢ï¼Œæ™ºèƒ½å›é€€æœºåˆ¶ç¡®ä¿é²æ£’æ€§

## ğŸ‹ï¸ è®­ç»ƒ

### ä½¿ç”¨ç»Ÿä¸€è®­ç»ƒè„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# å°æ•°æ®é›†è®­ç»ƒ
python scripts/train.py --scale small

# ä¸­ç­‰æ•°æ®é›†è®­ç»ƒ
python scripts/train.py --scale medium --config configs/medium_dataset.yaml

# å¤§æ•°æ®é›†è®­ç»ƒ
python scripts/train.py --scale large --config configs/large_dataset.yaml

# ä»æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒ
python scripts/train.py --scale medium --resume experiments/checkpoints/checkpoint_epoch_50.pth
```

### ä½¿ç”¨é…ç½®æ–‡ä»¶

```bash
# ä½¿ç”¨YAMLé…ç½®æ–‡ä»¶
python scripts/train.py --config configs/small_dataset.yaml

# ä½¿ç”¨JSONé…ç½®æ–‡ä»¶ï¼ˆå…¼å®¹æ—§ç‰ˆæœ¬ï¼‰
python scripts/train.py --config config.json
```

### ç¼–ç¨‹æ¥å£è®­ç»ƒ

```python
from wavespectra2text import create_model, vocab, create_trainer
from wavespectra2text.training.config import get_default_config
from wavespectra2text.data.dataset import AudioDataset

# åŠ è½½é…ç½®
config = get_default_config('medium')

# åˆ›å»ºæ•°æ®é›†
dataset = AudioDataset(
    labels_file='data/labels.csv',
    audio_dir='data/audio',
    mode='realtime'
)

# åˆ›å»ºæ¨¡å‹
model = create_model(
    vocab_size=vocab.vocab_size,
    hidden_dim=config['hidden_dim'],
    encoder_layers=config['encoder_layers'],
    decoder_layers=config['decoder_layers'],
    dropout=config['dropout']
)

# åˆ›å»ºè®­ç»ƒå™¨
trainer = create_trainer('medium', model, train_loader, val_loader, device, config)

# å¼€å§‹è®­ç»ƒ
trainer.train(config['num_epochs'])
```

## ğŸ¯ æ¨ç†

### ä½¿ç”¨ç»Ÿä¸€æ¨ç†è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# è‡ªåŠ¨æ¨¡å¼ - æ ¹æ®æ–‡ä»¶æ‰©å±•åè‡ªåŠ¨é€‰æ‹©è¾“å…¥æ¨¡å¼
python scripts/inference.py --model experiments/checkpoints/best_model.pth --input data/audio/Chinese_Number_01.wav

# æŒ‡å®šè¾“å…¥æ¨¡å¼
python scripts/inference.py --model experiments/checkpoints/best_model.pth --input data/audio/Chinese_Number_01.wav --mode audio
python scripts/inference.py --model experiments/checkpoints/best_model.pth --input data/features/Chinese_Number_01.npy --mode spectrogram

# æŸ¥çœ‹æ€§èƒ½å¯¹æ¯”å’Œæ¼”ç¤ºä»£ç 
python scripts/inference.py --compare
python scripts/inference.py --demo
```

### ç¼–ç¨‹æ¥å£æ¨ç†

```python
from wavespectra2text import DualInputSpeechRecognizer

# åˆ›å»ºè¯†åˆ«å™¨
recognizer = DualInputSpeechRecognizer('experiments/checkpoints/best_model.pth')

# éŸ³é¢‘è¯†åˆ«
result = recognizer.recognize_from_audio('data/audio/Chinese_Number_01.wav')
print(f"è¯†åˆ«ç»“æœ: {result['text']}")

# é¢‘è°±è¯†åˆ«ï¼ˆæ›´å¿«ï¼‰
result = recognizer.recognize_from_spectrogram('data/features/Chinese_Number_01.npy')
print(f"è¯†åˆ«ç»“æœ: {result['text']}")

# è‡ªåŠ¨æ¨¡å¼
result = recognizer.auto_recognize('data/audio/Chinese_Number_01.wav')  # éŸ³é¢‘æ–‡ä»¶
result = recognizer.auto_recognize('data/features/Chinese_Number_01.npy')  # é¢‘è°±æ–‡ä»¶
```

## ğŸ”§ æ•°æ®é¢„å¤„ç†

### å¿«é€Ÿå¼€å§‹ - æ•°æ®è®¾ç½®
```bash
# è‡ªåŠ¨æ‰«æéŸ³é¢‘æ–‡ä»¶å¹¶åˆ›å»ºæ ‡ç­¾æ¨¡æ¿
python setup_data.py
```

### æ‰¹é‡é¢„å¤„ç†ï¼ˆæ¨èç”¨äºå¤§æ•°æ®é›†ï¼‰
```bash
# æ‰¹é‡é¢„å¤„ç†éŸ³é¢‘æ–‡ä»¶ä¸ºé¢‘è°±ç‰¹å¾ï¼Œå¤§å¹…æå‡è®­ç»ƒé€Ÿåº¦
python batch_preprocess.py --audio_dir data/audio --labels_file data/labels.csv --output_dir data/features

# ä½¿ç”¨ä¸åŒçš„é¢„å¤„ç†å™¨
python batch_preprocess.py --preprocessor mel_spectrogram --n_mels 128

# å¼ºåˆ¶é‡æ–°è®¡ç®—æ‰€æœ‰ç‰¹å¾
python batch_preprocess.py --force_recompute
```

### æ•°æ®åŠ è½½æ¨¡å¼
```python
from data_utils import get_dataloader

# è‡ªåŠ¨æ¨¡å¼ï¼šä¼˜å…ˆä½¿ç”¨é¢„è®¡ç®—ç‰¹å¾ï¼Œå¦åˆ™å®æ—¶è®¡ç®—
dataloader = get_dataloader(mode='auto', batch_size=4)

# å®æ—¶æ¨¡å¼ï¼šæ¯æ¬¡è®­ç»ƒæ—¶è®¡ç®—ç‰¹å¾
dataloader = get_dataloader(mode='realtime', batch_size=4)

# é¢„è®¡ç®—æ¨¡å¼ï¼šä½¿ç”¨é¢„å¤„ç†å¥½çš„ç‰¹å¾ï¼ˆæœ€å¿«ï¼‰
dataloader = get_dataloader(mode='precomputed', precomputed_dir='data/features')
```

## âš™ï¸ é…ç½®å‚æ•°

### è®­ç»ƒé…ç½® (config.json)
```json
{
  "batch_size": 1,           // æ‰¹å¤§å°ï¼ˆå°æ•°æ®é›†æ¨è1ï¼‰
  "learning_rate": 0.00005,  // å­¦ä¹ ç‡
  "hidden_dim": 32,          // éšè—å±‚ç»´åº¦ï¼ˆå°æ•°æ®é›†æ¨è32ï¼‰
  "encoder_layers": 2,       // ç¼–ç å™¨å±‚æ•°
  "decoder_layers": 2,       // è§£ç å™¨å±‚æ•°
  "dropout": 0.1,            // Dropoutæ¯”ç‡
  "num_epochs": 200          // è®­ç»ƒè½®æ•°
}
```

### éŸ³é¢‘é¢„å¤„ç†å‚æ•°
- `sample_rate`: é‡‡æ ·ç‡ (é»˜è®¤: 48000Hz)
- `n_fft`: FFTçª—å£å¤§å° (é»˜è®¤: 1024)
- `hop_length`: è·³è·ƒé•¿åº¦ (é»˜è®¤: 512)
- `max_length`: æœ€å¤§åºåˆ—é•¿åº¦ (é»˜è®¤: 200)

## ğŸš€ æŠ€æœ¯ç‰¹ç‚¹

### åŒè¾“å…¥æ¶æ„ä¼˜åŠ¿
1. **çµæ´»æ€§**: æ”¯æŒåŸå§‹éŸ³é¢‘å’Œé¢„å¤„ç†é¢‘è°±ä¸¤ç§è¾“å…¥
2. **æ€§èƒ½**: é¢‘è°±è¾“å…¥æ¨¡å¼å¯æå‡æ¨ç†é€Ÿåº¦5-10å€
3. **å…¼å®¹æ€§**: å¯ä¸å¤–éƒ¨é¢„å¤„ç†ç³»ç»Ÿæ— ç¼é›†æˆ
4. **å¯æ‰©å±•**: æ”¯æŒå¤šç§é¢„å¤„ç†ç­–ç•¥ï¼ˆSTFTã€Melé¢‘è°±ç­‰ï¼‰

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
1. **æ·±åº¦å­¦ä¹ æ¡†æ¶**: PyTorch 1.9+ (æ”¯æŒGPU/CPU)
2. **éŸ³é¢‘å¤„ç†**: librosa, soundfile (ä¸“ä¸šéŸ³é¢‘å¤„ç†)
3. **é¢‘è°±ç‰¹å¾**: STFTæå–éŸ³é¢‘é¢‘è°±ï¼Œè½¬æ¢ä¸ºå¯¹æ•°åˆ»åº¦ (200Ã—513)
4. **æ¨¡å‹æ¶æ„**: Transformerç¼–ç å™¨-è§£ç å™¨ï¼Œå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶
5. **æ¨ç†ç­–ç•¥**: è´ªå©ªè§£ç  + æŸæœç´¢ + æ™ºèƒ½å›é€€æœºåˆ¶
6. **æ•°æ®å¤„ç†**: pandas, numpy (é«˜æ•ˆæ•°æ®å¤„ç†)
7. **å¯è§†åŒ–**: TensorBoard (è®­ç»ƒç›‘æ§)
8. **å·¥å…·é“¾**: tqdm (è¿›åº¦æ¡), argparse (å‘½ä»¤è¡Œ)

### æ¶æ„è®¾è®¡
1. **æ¨¡å—åŒ–è®¾è®¡**: ä½è€¦åˆã€é«˜å†…èšçš„æ¨¡å—æ¶æ„
2. **ç»Ÿä¸€æ¥å£**: ç»Ÿä¸€çš„è®­ç»ƒåŸºç±»å’Œæ¨ç†æ ¸å¿ƒ
3. **ç¼“å­˜ç³»ç»Ÿ**: æ”¯æŒç‰¹å¾ç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—
4. **æ‰¹é‡å¤„ç†**: é«˜æ•ˆçš„æ‰¹é‡é¢„å¤„ç†å’Œæ¨ç†
5. **é…ç½®ç®¡ç†**: JSONé…ç½®æ–‡ä»¶ï¼Œæ”¯æŒä¸åŒè§„æ¨¡è®­ç»ƒ
6. **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æ¢å¤æœºåˆ¶

## ç›‘æ§è®­ç»ƒ

ä½¿ç”¨TensorBoardç›‘æ§è®­ç»ƒè¿‡ç¨‹ï¼š

```bash
tensorboard --logdir runs
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. æ•°æ®ç›¸å…³
```bash
# é—®é¢˜ï¼šéŸ³é¢‘æ–‡ä»¶ä¸å­˜åœ¨æˆ–è·¯å¾„é”™è¯¯
# è§£å†³ï¼šè¿è¡Œæ•°æ®éªŒè¯å·¥å…·
python setup_data.py

# é—®é¢˜ï¼šæ ‡ç­¾æ–‡ä»¶æ ¼å¼é”™è¯¯
# è§£å†³ï¼šæ£€æŸ¥CSVæ–‡ä»¶æ ¼å¼ï¼Œç¡®ä¿åŒ…å«filenameå’Œlabelåˆ—
```

#### 2. ä¾èµ–å’Œç¯å¢ƒ
```bash
# é—®é¢˜ï¼šImportErroræˆ–æ¨¡å—ç¼ºå¤±
pip install -r requirements.txt

# é—®é¢˜ï¼šlibrosaå®‰è£…å¤±è´¥
pip install librosa soundfile

# é—®é¢˜ï¼šCUDAé”™è¯¯ï¼ˆGPUä¸å¯ç”¨ï¼‰
# è§£å†³ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨CPUï¼Œæ— éœ€ç‰¹æ®Šå¤„ç†
```

#### 3. å†…å­˜å’Œæ€§èƒ½
```bash
# é—®é¢˜ï¼šå†…å­˜ä¸è¶³ (OOM)
# è§£å†³ï¼šå‡å°‘batch_sizeæˆ–hidden_dim
# ç¼–è¾‘config.json: "batch_size": 1, "hidden_dim": 16

# é—®é¢˜ï¼šè®­ç»ƒé€Ÿåº¦æ…¢
# è§£å†³ï¼šä½¿ç”¨é¢„è®¡ç®—æ¨¡å¼
python batch_preprocess.py --audio_dir data/audio --labels_file data/labels.csv
```

### ğŸš€ æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### è®­ç»ƒä¼˜åŒ–
1. **ä½¿ç”¨é¢„è®¡ç®—ç‰¹å¾**: è¿è¡Œ `batch_preprocess.py` é¢„å¤„ç†æ‰€æœ‰éŸ³é¢‘
2. **GPUåŠ é€Ÿ**: è®¾ç½® `--device cuda` ï¼ˆå¦‚æœæœ‰GPUï¼‰
3. **æ‰¹å¤§å°è°ƒä¼˜**: æ ¹æ®å†…å­˜å¤§å°è°ƒæ•´ `batch_size`
4. **æ¨¡å‹å¤§å°**: å°æ•°æ®é›†ä½¿ç”¨å°æ¨¡å‹ï¼ˆhidden_dim=32ï¼‰

#### æ¨ç†ä¼˜åŒ–
1. **ä½¿ç”¨é¢‘è°±è¾“å…¥æ¨¡å¼**: é€Ÿåº¦æå‡5-10å€
2. **æ‰¹é‡æ¨ç†**: ä½¿ç”¨ `dual_input_inference.py` çš„æ‰¹é‡åŠŸèƒ½
3. **ç¼“å­˜æœºåˆ¶**: å¯ç”¨ç‰¹å¾ç¼“å­˜é¿å…é‡å¤è®¡ç®—

## ğŸŒŸ æ‰©å±•åŠŸèƒ½

### å·²å®ç°çš„æ‰©å±•
- âœ… **åŒè¾“å…¥æ¶æ„**: æ”¯æŒéŸ³é¢‘å’Œé¢‘è°±ä¸¤ç§è¾“å…¥
- âœ… **å¤šç§é¢„å¤„ç†å™¨**: STFTé¢‘è°±ã€Melé¢‘è°±
- âœ… **æ™ºèƒ½æ¨ç†**: è´ªå©ªè§£ç  + æŸæœç´¢ + å›é€€æœºåˆ¶
- âœ… **æ‰¹é‡å¤„ç†**: é«˜æ•ˆçš„æ‰¹é‡é¢„å¤„ç†å’Œæ¨ç†
- âœ… **ç¼“å­˜ç³»ç»Ÿ**: ç‰¹å¾ç¼“å­˜å’Œé…ç½®ç®¡ç†
- âœ… **ç»Ÿä¸€è®­ç»ƒåŸºç±»**: å‡å°‘ä»£ç å†—ä½™ï¼Œæ”¯æŒå¤šç§è§„æ¨¡è®­ç»ƒ
- âœ… **æ¨¡å—åŒ–è®¾è®¡**: ä½è€¦åˆã€é«˜æ‰©å±•æ€§çš„æ¶æ„
- âœ… **è‡ªåŠ¨æ•°æ®æ›´æ–°**: æ•°æ®å˜åŒ–è‡ªåŠ¨åŒæ­¥

### å¯æ‰©å±•æ–¹å‘
- ğŸ”„ **æ›´å¤šä¸­æ–‡è¯æ±‡**: æ‰©å±•è¯æ±‡è¡¨æ”¯æŒæ›´å¤šæ±‰å­—
- ğŸ”„ **æ•°æ®å¢å¼º**: æ·»åŠ å™ªå£°ã€é€Ÿåº¦å˜åŒ–ç­‰å¢å¼ºæŠ€æœ¯
- ğŸ”„ **å®æ—¶è¯†åˆ«**: WebSocketå®æ—¶éŸ³é¢‘æµå¤„ç†
- ğŸ”„ **å¤šè¯­è¨€æ”¯æŒ**: æ”¯æŒè‹±æ–‡ã€æ—¥æ–‡ç­‰å…¶ä»–è¯­è¨€
- ğŸ”„ **è¯­è¨€æ¨¡å‹**: é›†æˆN-gramæˆ–ç¥ç»è¯­è¨€æ¨¡å‹åå¤„ç†
- ğŸ”„ **æ¨¡å‹å‹ç¼©**: é‡åŒ–ã€å‰ªæç­‰æ¨¡å‹å‹ç¼©æŠ€æœ¯
- ğŸ”„ **Webç•Œé¢**: åŸºäºFlask/FastAPIçš„WebæœåŠ¡
- ğŸ”„ **ç§»åŠ¨ç«¯**: æ”¯æŒiOS/Androidçš„ç§»åŠ¨åº”ç”¨

## å…¶ä»–è¯´æ˜

### å¯é€‰

- å¯é€‰éŸ³é¢‘æ ¼å¼å‚è€ƒï¼šwav
- data/audioä¸­çš„Chinese_Number_xx.wavç­‰éŸ³é¢‘æ–‡ä»¶æ¥è‡ªLogic Proè‡ªå¸¦å£°éŸ³åŒ…ï¼Œä»…ä¾›å­¦ä¹ ä½¿ç”¨
- 
